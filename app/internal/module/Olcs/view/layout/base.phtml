<?php
{
    $title = null;
    if (isset($this->pageTitle)) {
        $title = $this->pageTitle;
    } else {
        $title = $this->getPlaceholder('pageTitle')->asString();
    }

    $subTitle = null;
    if (isset($pageSubTitle)) {
        $subTitle = $pageSubTitle;
    } else {
        $subTitle = $this->getPlaceholder('pageSubtitle')->asString();
    }

    if (!isset($contentTitle)) {
        $contentTitle = $this->getPlaceholder('contentTitle')->asString();
    }

    // We may have right content in a placeholder
    if (!isset($right)) {
        $right = $this->getPlaceholder('right')->asView();
    }

    // We may have nav id in a placeholder
    if (!isset($horizontalNavigationId)) {
        $horizontalNavigationId = $this->getPlaceholder('horizontalNavigationId')->asString();
    }

    if (!isset($horizontalNavigationContainer)) {
        $horizontalNavigationContainer = $this->getPlaceholder('horizontalNavigationContainer')->asObject();
    }
}

$this->doctype();
?>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <?php
    {
        echo $this->headTitle(strip_tags($title));
        echo $this->headMeta()->appendName('viewport', 'width=device-width, initial-scale=1.0')->appendHttpEquiv('X-UA-Compatible', 'IE=edge');
        /* echo $this->headLink(array('rel' => 'shortcut icon', 'type' => 'image/vnd.microsoft.icon', 'href' => $this->basePath() . '/img/favicon.ico')); */
        echo $this->headLink()->appendStylesheet($this->assetPath('/styles/' . $this->applicationName() . '.css'));
        echo $this->headScript();
    }
    ?>
  </head>
  <body class="internal">
    <?php echo $this->version(); ?>
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>
    <?php
    echo $this->partial('layout/partials/global-header');
    echo $this->partial('layout/partials/header', ['title' => $title, 'subTitle' => $subTitle]); ?>
    <div class="page-wrapper">
      <div id="main" role="main">
<?php if (isset($right)): ?>
        <div class="four-fifths--left">
<?php endif; ?>

<?php
if (!empty($horizontalNavigationId)) {
    echo $this->navigation('navigation')
        ->menu($this->navigation()->findOneBy('id', $horizontalNavigationId))
        ->setPartial('partials/horizontal-navigation');
} elseif(!empty($horizontalNavigationContainer)) {
    echo $this->navigation($horizontalNavigationContainer)->menu()->setPartial('partials/horizontal-navigation');
}
?>
          <div class="content">
<?php if (isset($this->left)): ?>
            <div class="one-fifth--left">
              <?php echo $this->left; ?>
            </div><!-- End: one-fifth--left -->
            <div class="three-fifths">
<?php endif;

if (!empty($contentTitle)): ?>
              <div class="content__header js-title">
                <h3><?php echo $this->translate($contentTitle); ?></h3>
              </div><!-- End: js-title -->
<?php endif; ?>
              <div class="js-body">
                <?php
                  echo $this->flashMessengerAll();
                  echo $this->content;
                ?>
              </div><!-- End: js-body -->
<?php if (isset($this->left)): ?>
            </div><!-- End: three-fifths -->
<?php endif; ?>
          </div><!-- End: content -->
<?php

if (isset($right)): ?>
        </div><!-- End: four-fifths--left -->
<?php endif;

if (!empty($right)): ?>
        <div class="one-fifth--right">
          <?php echo $this->render($right); ?>
        </div><!-- one-fifth-right -->
<?php endif; ?>
      </div><!-- End: main -->
    </div><!-- .page-wrapper-->

  <!-- Start: Global and Inline Script -->
  <?php echo $this->inlineScript()->prependFile($this->assetPath('js/' . $this->applicationName() . '.js')); ?>
  <!-- End: Global and Inline Script -->

  <script>
    OLCS.ready(function() {
      OLCS.eventEmitter.emit("render");
    });
  </script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];
    a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    <?php

    if (isset($userId)) {
      $gacode = "ga('create', 'UA-56585177-1', 'auto', {'userId': '%s'});";
      echo sprintf($gacode, $userId);
    } else {
      $gacode = "ga('create', 'UA-56585177-1', 'auto');";
      echo sprintf($gacode);
    }?>

    ga('send', 'pageview');
  </script>
  </body>
</html>
